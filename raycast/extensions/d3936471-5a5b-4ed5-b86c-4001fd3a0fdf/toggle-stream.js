var Ln=Object.create;var Ce=Object.defineProperty,Bn=Object.defineProperties,Dn=Object.getOwnPropertyDescriptor,kn=Object.getOwnPropertyDescriptors,Pn=Object.getOwnPropertyNames,lr=Object.getOwnPropertySymbols,Mn=Object.getPrototypeOf,ur=Object.prototype.hasOwnProperty,Nn=Object.prototype.propertyIsEnumerable;var hr=(r,e,t)=>e in r?Ce(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,N=(r,e)=>{for(var t in e||(e={}))ur.call(e,t)&&hr(r,t,e[t]);if(lr)for(var t of lr(e))Nn.call(e,t)&&hr(r,t,e[t]);return r},te=(r,e)=>Bn(r,kn(e)),dr=r=>Ce(r,"__esModule",{value:!0});var x=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Rn=(r,e)=>{for(var t in e)Ce(r,t,{get:e[t],enumerable:!0})},pr=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Pn(e))!ur.call(r,n)&&(t||n!=="default")&&Ce(r,n,{get:()=>e[n],enumerable:!(s=Dn(e,n))||s.enumerable});return r},ue=(r,e)=>pr(dr(Ce(r!=null?Ln(Mn(r)):{},"default",!e&&r&&r.__esModule?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),Fn=(r=>(e,t)=>r&&r.get(e)||(t=pr(dr({}),e,1),r&&r.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var Te=x(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.getUint64=q.getInt64=q.setInt64=q.setUint64=q.UINT32_MAX=void 0;q.UINT32_MAX=4294967295;function qn(r,e,t){let s=t/4294967296,n=t;r.setUint32(e,s),r.setUint32(e+4,n)}q.setUint64=qn;function $n(r,e,t){let s=Math.floor(t/4294967296),n=t;r.setUint32(e,s),r.setUint32(e+4,n)}q.setInt64=$n;function Vn(r,e){let t=r.getInt32(e),s=r.getUint32(e+4);return t*4294967296+s}q.getInt64=Vn;function Wn(r,e){let t=r.getUint32(e),s=r.getUint32(e+4);return t*4294967296+s}q.getUint64=Wn});var ze=x(L=>{"use strict";var St,Ct,Tt;Object.defineProperty(L,"__esModule",{value:!0});L.utf8DecodeTD=L.TEXT_DECODER_THRESHOLD=L.utf8DecodeJs=L.utf8EncodeTE=L.TEXT_ENCODER_THRESHOLD=L.utf8EncodeJs=L.utf8Count=void 0;var mr=Te(),We=(typeof process>"u"||((St=process==null?void 0:process.env)===null||St===void 0?void 0:St.TEXT_ENCODING)!=="never")&&typeof TextEncoder<"u"&&typeof TextDecoder<"u";function zn(r){let e=r.length,t=0,s=0;for(;s<e;){let n=r.charCodeAt(s++);if((n&4294967168)===0){t++;continue}else if((n&4294965248)===0)t+=2;else{if(n>=55296&&n<=56319&&s<e){let i=r.charCodeAt(s);(i&64512)===56320&&(++s,n=((n&1023)<<10)+(i&1023)+65536)}(n&4294901760)===0?t+=3:t+=4}}return t}L.utf8Count=zn;function Hn(r,e,t){let s=r.length,n=t,i=0;for(;i<s;){let o=r.charCodeAt(i++);if((o&4294967168)===0){e[n++]=o;continue}else if((o&4294965248)===0)e[n++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<s){let f=r.charCodeAt(i);(f&64512)===56320&&(++i,o=((o&1023)<<10)+(f&1023)+65536)}(o&4294901760)===0?(e[n++]=o>>12&15|224,e[n++]=o>>6&63|128):(e[n++]=o>>18&7|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128)}e[n++]=o&63|128}}L.utf8EncodeJs=Hn;var be=We?new TextEncoder:void 0;L.TEXT_ENCODER_THRESHOLD=We?typeof process<"u"&&((Ct=process==null?void 0:process.env)===null||Ct===void 0?void 0:Ct.TEXT_ENCODING)!=="force"?200:0:mr.UINT32_MAX;function jn(r,e,t){e.set(be.encode(r),t)}function Gn(r,e,t){be.encodeInto(r,e.subarray(t))}L.utf8EncodeTE=(be==null?void 0:be.encodeInto)?Gn:jn;var Xn=4096;function Kn(r,e,t){let s=e,n=s+t,i=[],o="";for(;s<n;){let f=r[s++];if((f&128)===0)i.push(f);else if((f&224)===192){let c=r[s++]&63;i.push((f&31)<<6|c)}else if((f&240)===224){let c=r[s++]&63,l=r[s++]&63;i.push((f&31)<<12|c<<6|l)}else if((f&248)===240){let c=r[s++]&63,l=r[s++]&63,h=r[s++]&63,a=(f&7)<<18|c<<12|l<<6|h;a>65535&&(a-=65536,i.push(a>>>10&1023|55296),a=56320|a&1023),i.push(a)}else i.push(f);i.length>=Xn&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}L.utf8DecodeJs=Kn;var Yn=We?new TextDecoder:null;L.TEXT_DECODER_THRESHOLD=We?typeof process<"u"&&((Tt=process==null?void 0:process.env)===null||Tt===void 0?void 0:Tt.TEXT_DECODER)!=="force"?200:0:mr.UINT32_MAX;function Jn(r,e,t){let s=r.subarray(e,e+t);return Yn.decode(s)}L.utf8DecodeTD=Jn});var bt=x(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.ExtData=void 0;var _r=class{constructor(e,t){this.type=e,this.data=t}};He.ExtData=_r});var Ge=x(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.DecodeError=void 0;var Oe=class extends Error{constructor(e){super(e);let t=Object.create(Oe.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Oe.name})}};je.DecodeError=Oe});var Ot=x(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.timestampExtension=I.decodeTimestampExtension=I.decodeTimestampToTimeSpec=I.encodeTimestampExtension=I.encodeDateToTimeSpec=I.encodeTimeSpecToTimestamp=I.EXT_TIMESTAMP=void 0;var Zn=Ge(),yr=Te();I.EXT_TIMESTAMP=-1;var Qn=4294967296-1,ei=17179869184-1;function gr({sec:r,nsec:e}){if(r>=0&&e>=0&&r<=ei)if(e===0&&r<=Qn){let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,r),t}else{let t=r/4294967296,s=r&4294967295,n=new Uint8Array(8),i=new DataView(n.buffer);return i.setUint32(0,e<<2|t&3),i.setUint32(4,s),n}else{let t=new Uint8Array(12),s=new DataView(t.buffer);return s.setUint32(0,e),(0,yr.setInt64)(s,4,r),t}}I.encodeTimeSpecToTimestamp=gr;function xr(r){let e=r.getTime(),t=Math.floor(e/1e3),s=(e-t*1e3)*1e6,n=Math.floor(s/1e9);return{sec:t+n,nsec:s-n*1e9}}I.encodeDateToTimeSpec=xr;function wr(r){if(r instanceof Date){let e=xr(r);return gr(e)}else return null}I.encodeTimestampExtension=wr;function vr(r){let e=new DataView(r.buffer,r.byteOffset,r.byteLength);switch(r.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{let t=e.getUint32(0),s=e.getUint32(4),n=(t&3)*4294967296+s,i=t>>>2;return{sec:n,nsec:i}}case 12:{let t=(0,yr.getInt64)(e,4),s=e.getUint32(0);return{sec:t,nsec:s}}default:throw new Zn.DecodeError(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${r.length}`)}}I.decodeTimestampToTimeSpec=vr;function Er(r){let e=vr(r);return new Date(e.sec*1e3+e.nsec/1e6)}I.decodeTimestampExtension=Er;I.timestampExtension={type:I.EXT_TIMESTAMP,encode:wr,decode:Er}});var Je=x(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.ExtensionCodec=void 0;var Xe=bt(),ti=Ot(),Ke=class{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(ti.timestampExtension)}register({type:e,encode:t,decode:s}){if(e>=0)this.encoders[e]=t,this.decoders[e]=s;else{let n=1+e;this.builtInEncoders[n]=t,this.builtInDecoders[n]=s}}tryToEncode(e,t){for(let s=0;s<this.builtInEncoders.length;s++){let n=this.builtInEncoders[s];if(n!=null){let i=n(e,t);if(i!=null){let o=-1-s;return new Xe.ExtData(o,i)}}}for(let s=0;s<this.encoders.length;s++){let n=this.encoders[s];if(n!=null){let i=n(e,t);if(i!=null){let o=s;return new Xe.ExtData(o,i)}}}return e instanceof Xe.ExtData?e:null}decode(e,t,s){let n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,s):new Xe.ExtData(t,e)}};Ye.ExtensionCodec=Ke;Ke.defaultCodec=new Ke});var Ut=x(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.createDataView=de.ensureUint8Array=void 0;function Sr(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Uint8Array.from(r)}de.ensureUint8Array=Sr;function ri(r){if(r instanceof ArrayBuffer)return new DataView(r);let e=Sr(r);return new DataView(e.buffer,e.byteOffset,e.byteLength)}de.createDataView=ri});var It=x(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.Encoder=W.DEFAULT_INITIAL_BUFFER_SIZE=W.DEFAULT_MAX_DEPTH=void 0;var Ue=ze(),si=Je(),Cr=Te(),ni=Ut();W.DEFAULT_MAX_DEPTH=100;W.DEFAULT_INITIAL_BUFFER_SIZE=2048;var Tr=class{constructor(e=si.ExtensionCodec.defaultCodec,t=void 0,s=W.DEFAULT_MAX_DEPTH,n=W.DEFAULT_INITIAL_BUFFER_SIZE,i=!1,o=!1,f=!1,c=!1){this.extensionCodec=e,this.context=t,this.maxDepth=s,this.initialBufferSize=n,this.sortKeys=i,this.forceFloat32=o,this.ignoreUndefined=f,this.forceIntegerToFloat=c,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}getUint8Array(){return this.bytes.subarray(0,this.pos)}reinitializeState(){this.pos=0}encode(e){return this.reinitializeState(),this.doEncode(e,1),this.getUint8Array()}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){let t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(t*2)}resizeBuffer(e){let t=new ArrayBuffer(e),s=new Uint8Array(t),n=new DataView(t);s.set(this.bytes),this.view=n,this.bytes=s}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){if(e.length>Ue.TEXT_ENCODER_THRESHOLD){let n=(0,Ue.utf8Count)(e);this.ensureBufferSizeToWrite(5+n),this.writeStringHeader(n),(0,Ue.utf8EncodeTE)(e,this.bytes,this.pos),this.pos+=n}else{let n=(0,Ue.utf8Count)(e);this.ensureBufferSizeToWrite(5+n),this.writeStringHeader(n),(0,Ue.utf8EncodeJs)(e,this.bytes,this.pos),this.pos+=n}}encodeObject(e,t){let s=this.extensionCodec.tryToEncode(e,this.context);if(s!=null)this.encodeExtension(s);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,t);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){let t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else if(t<4294967296)this.writeU8(198),this.writeU32(t);else throw new Error(`Too large binary: ${t}`);let s=(0,ni.ensureUint8Array)(e);this.writeU8a(s)}encodeArray(e,t){let s=e.length;if(s<16)this.writeU8(144+s);else if(s<65536)this.writeU8(220),this.writeU16(s);else if(s<4294967296)this.writeU8(221),this.writeU32(s);else throw new Error(`Too large array: ${s}`);for(let n of e)this.doEncode(n,t+1)}countWithoutUndefined(e,t){let s=0;for(let n of t)e[n]!==void 0&&s++;return s}encodeMap(e,t){let s=Object.keys(e);this.sortKeys&&s.sort();let n=this.ignoreUndefined?this.countWithoutUndefined(e,s):s.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else if(n<4294967296)this.writeU8(223),this.writeU32(n);else throw new Error(`Too large map object: ${n}`);for(let i of s){let o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,t+1))}}encodeExtension(e){let t=e.data.length;if(t===1)this.writeU8(212);else if(t===2)this.writeU8(213);else if(t===4)this.writeU8(214);else if(t===8)this.writeU8(215);else if(t===16)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else if(t<4294967296)this.writeU8(201),this.writeU32(t);else throw new Error(`Too large extension object: ${t}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){let t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),(0,Cr.setUint64)(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),(0,Cr.setInt64)(this.view,this.pos,e),this.pos+=8}};W.Encoder=Tr});var br=x(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.encode=void 0;var ii=It(),oi={};function ai(r,e=oi){return new ii.Encoder(e.extensionCodec,e.context,e.maxDepth,e.initialBufferSize,e.sortKeys,e.forceFloat32,e.ignoreUndefined,e.forceIntegerToFloat).encode(r)}Ze.encode=ai});var Or=x(Qe=>{"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});Qe.prettyByte=void 0;function ci(r){return`${r<0?"-":""}0x${Math.abs(r).toString(16).padStart(2,"0")}`}Qe.prettyByte=ci});var Ir=x(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.CachedKeyDecoder=void 0;var fi=ze(),li=16,hi=16,Ur=class{constructor(e=li,t=hi){this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(let s=0;s<this.maxKeyLength;s++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,s){let n=this.caches[s-1];e:for(let i of n){let o=i.bytes;for(let f=0;f<s;f++)if(o[f]!==e[t+f])continue e;return i.str}return null}store(e,t){let s=this.caches[e.length-1],n={bytes:e,str:t};s.length>=this.maxLengthPerKey?s[Math.random()*s.length|0]=n:s.push(n)}decode(e,t,s){let n=this.find(e,t,s);if(n!=null)return this.hit++,n;this.miss++;let i=(0,fi.utf8DecodeJs)(e,t,s),o=Uint8Array.prototype.slice.call(e,t,t+s);return this.store(o,i),i}};et.CachedKeyDecoder=Ur});var tt=x(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.Decoder=Y.DataViewIndexOutOfBoundsError=void 0;var At=Or(),ui=Je(),ce=Te(),Lt=ze(),Bt=Ut(),di=Ir(),K=Ge(),pi=r=>{let e=typeof r;return e==="string"||e==="number"},Ie=-1,Dt=new DataView(new ArrayBuffer(0)),mi=new Uint8Array(Dt.buffer);Y.DataViewIndexOutOfBoundsError=(()=>{try{Dt.getInt8(0)}catch(r){return r.constructor}throw new Error("never reached")})();var Ar=new Y.DataViewIndexOutOfBoundsError("Insufficient data"),_i=new di.CachedKeyDecoder,Lr=class{constructor(e=ui.ExtensionCodec.defaultCodec,t=void 0,s=ce.UINT32_MAX,n=ce.UINT32_MAX,i=ce.UINT32_MAX,o=ce.UINT32_MAX,f=ce.UINT32_MAX,c=_i){this.extensionCodec=e,this.context=t,this.maxStrLength=s,this.maxBinLength=n,this.maxArrayLength=i,this.maxMapLength=o,this.maxExtLength=f,this.keyDecoder=c,this.totalPos=0,this.pos=0,this.view=Dt,this.bytes=mi,this.headByte=Ie,this.stack=[]}reinitializeState(){this.totalPos=0,this.headByte=Ie,this.stack.length=0}setBuffer(e){this.bytes=(0,Bt.ensureUint8Array)(e),this.view=(0,Bt.createDataView)(this.bytes),this.pos=0}appendBuffer(e){if(this.headByte===Ie&&!this.hasRemaining(1))this.setBuffer(e);else{let t=this.bytes.subarray(this.pos),s=(0,Bt.ensureUint8Array)(e),n=new Uint8Array(t.length+s.length);n.set(t),n.set(s,t.length),this.setBuffer(n)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){let{view:t,pos:s}=this;return new RangeError(`Extra ${t.byteLength-s} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){this.reinitializeState(),this.setBuffer(e);let t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}*decodeMulti(e){for(this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}async decodeAsync(e){let t=!1,s;for await(let f of e){if(t)throw this.createExtraByteError(this.totalPos);this.appendBuffer(f);try{s=this.doDecodeSync(),t=!0}catch(c){if(!(c instanceof Y.DataViewIndexOutOfBoundsError))throw c}this.totalPos+=this.pos}if(t){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return s}let{headByte:n,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${(0,At.prettyByte)(n)} at ${o} (${i} in the current buffer)`)}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,t){let s=t,n=-1;for await(let i of e){if(t&&n===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),s&&(n=this.readArraySize(),s=!1,this.complete());try{for(;yield this.doDecodeSync(),--n!==0;);}catch(o){if(!(o instanceof Y.DataViewIndexOutOfBoundsError))throw o}this.totalPos+=this.pos}}doDecodeSync(){e:for(;;){let e=this.readHeadByte(),t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){let n=e-128;if(n!==0){this.pushMapState(n),this.complete();continue e}else t={}}else if(e<160){let n=e-144;if(n!==0){this.pushArrayState(n),this.complete();continue e}else t=[]}else{let n=e-160;t=this.decodeUtf8String(n,0)}else if(e===192)t=null;else if(e===194)t=!1;else if(e===195)t=!0;else if(e===202)t=this.readF32();else if(e===203)t=this.readF64();else if(e===204)t=this.readU8();else if(e===205)t=this.readU16();else if(e===206)t=this.readU32();else if(e===207)t=this.readU64();else if(e===208)t=this.readI8();else if(e===209)t=this.readI16();else if(e===210)t=this.readI32();else if(e===211)t=this.readI64();else if(e===217){let n=this.lookU8();t=this.decodeUtf8String(n,1)}else if(e===218){let n=this.lookU16();t=this.decodeUtf8String(n,2)}else if(e===219){let n=this.lookU32();t=this.decodeUtf8String(n,4)}else if(e===220){let n=this.readU16();if(n!==0){this.pushArrayState(n),this.complete();continue e}else t=[]}else if(e===221){let n=this.readU32();if(n!==0){this.pushArrayState(n),this.complete();continue e}else t=[]}else if(e===222){let n=this.readU16();if(n!==0){this.pushMapState(n),this.complete();continue e}else t={}}else if(e===223){let n=this.readU32();if(n!==0){this.pushMapState(n),this.complete();continue e}else t={}}else if(e===196){let n=this.lookU8();t=this.decodeBinary(n,1)}else if(e===197){let n=this.lookU16();t=this.decodeBinary(n,2)}else if(e===198){let n=this.lookU32();t=this.decodeBinary(n,4)}else if(e===212)t=this.decodeExtension(1,0);else if(e===213)t=this.decodeExtension(2,0);else if(e===214)t=this.decodeExtension(4,0);else if(e===215)t=this.decodeExtension(8,0);else if(e===216)t=this.decodeExtension(16,0);else if(e===199){let n=this.lookU8();t=this.decodeExtension(n,1)}else if(e===200){let n=this.lookU16();t=this.decodeExtension(n,2)}else if(e===201){let n=this.lookU32();t=this.decodeExtension(n,4)}else throw new K.DecodeError(`Unrecognized type byte: ${(0,At.prettyByte)(e)}`);this.complete();let s=this.stack;for(;s.length>0;){let n=s[s.length-1];if(n.type===0)if(n.array[n.position]=t,n.position++,n.position===n.size)s.pop(),t=n.array;else continue e;else if(n.type===1){if(!pi(t))throw new K.DecodeError("The type of key must be string or number but "+typeof t);if(t==="__proto__")throw new K.DecodeError("The key __proto__ is not allowed");n.key=t,n.type=2;continue e}else if(n.map[n.key]=t,n.readCount++,n.readCount===n.size)s.pop(),t=n.map;else{n.key=null,n.type=1;continue e}}return t}}readHeadByte(){return this.headByte===Ie&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=Ie}readArraySize(){let e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new K.DecodeError(`Unrecognized array type byte: ${(0,At.prettyByte)(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new K.DecodeError(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})}pushArrayState(e){if(e>this.maxArrayLength)throw new K.DecodeError(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.push({type:0,size:e,array:new Array(e),position:0})}decodeUtf8String(e,t){var s;if(e>this.maxStrLength)throw new K.DecodeError(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw Ar;let n=this.pos+t,i;return this.stateIsMapKey()&&((s=this.keyDecoder)===null||s===void 0?void 0:s.canBeCached(e))?i=this.keyDecoder.decode(this.bytes,n,e):e>Lt.TEXT_DECODER_THRESHOLD?i=(0,Lt.utf8DecodeTD)(this.bytes,n,e):i=(0,Lt.utf8DecodeJs)(this.bytes,n,e),this.pos+=t+e,i}stateIsMapKey(){return this.stack.length>0?this.stack[this.stack.length-1].type===1:!1}decodeBinary(e,t){if(e>this.maxBinLength)throw new K.DecodeError(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw Ar;let s=this.pos+t,n=this.bytes.subarray(s,s+e);return this.pos+=t+e,n}decodeExtension(e,t){if(e>this.maxExtLength)throw new K.DecodeError(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);let s=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,s,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){let e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){let e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){let e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){let e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){let e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){let e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){let e=(0,ce.getUint64)(this.view,this.pos);return this.pos+=8,e}readI64(){let e=(0,ce.getInt64)(this.view,this.pos);return this.pos+=8,e}readF32(){let e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){let e=this.view.getFloat64(this.pos);return this.pos+=8,e}};Y.Decoder=Lr});var kt=x(z=>{"use strict";Object.defineProperty(z,"__esModule",{value:!0});z.decodeMulti=z.decode=z.defaultDecodeOptions=void 0;var Br=tt();z.defaultDecodeOptions={};function yi(r,e=z.defaultDecodeOptions){return new Br.Decoder(e.extensionCodec,e.context,e.maxStrLength,e.maxBinLength,e.maxArrayLength,e.maxMapLength,e.maxExtLength).decode(r)}z.decode=yi;function gi(r,e=z.defaultDecodeOptions){return new Br.Decoder(e.extensionCodec,e.context,e.maxStrLength,e.maxBinLength,e.maxArrayLength,e.maxMapLength,e.maxExtLength).decodeMulti(r)}z.decodeMulti=gi});var Pr=x(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.ensureAsyncIterable=re.asyncIterableFromStream=re.isAsyncIterable=void 0;function Dr(r){return r[Symbol.asyncIterator]!=null}re.isAsyncIterable=Dr;function xi(r){if(r==null)throw new Error("Assertion Failure: value must not be null nor undefined")}async function*kr(r){let e=r.getReader();try{for(;;){let{done:t,value:s}=await e.read();if(t)return;xi(s),yield s}}finally{e.releaseLock()}}re.asyncIterableFromStream=kr;function wi(r){return Dr(r)?r:kr(r)}re.ensureAsyncIterable=wi});var Nr=x(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.decodeStream=H.decodeMultiStream=H.decodeArrayStream=H.decodeAsync=void 0;var Pt=tt(),Mt=Pr(),rt=kt();async function vi(r,e=rt.defaultDecodeOptions){let t=(0,Mt.ensureAsyncIterable)(r);return new Pt.Decoder(e.extensionCodec,e.context,e.maxStrLength,e.maxBinLength,e.maxArrayLength,e.maxMapLength,e.maxExtLength).decodeAsync(t)}H.decodeAsync=vi;function Ei(r,e=rt.defaultDecodeOptions){let t=(0,Mt.ensureAsyncIterable)(r);return new Pt.Decoder(e.extensionCodec,e.context,e.maxStrLength,e.maxBinLength,e.maxArrayLength,e.maxMapLength,e.maxExtLength).decodeArrayStream(t)}H.decodeArrayStream=Ei;function Mr(r,e=rt.defaultDecodeOptions){let t=(0,Mt.ensureAsyncIterable)(r);return new Pt.Decoder(e.extensionCodec,e.context,e.maxStrLength,e.maxBinLength,e.maxArrayLength,e.maxMapLength,e.maxExtLength).decodeStream(t)}H.decodeMultiStream=Mr;function Si(r,e=rt.defaultDecodeOptions){return Mr(r,e)}H.decodeStream=Si});var qr=x(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.decodeTimestampExtension=v.encodeTimestampExtension=v.decodeTimestampToTimeSpec=v.encodeTimeSpecToTimestamp=v.encodeDateToTimeSpec=v.EXT_TIMESTAMP=v.ExtData=v.ExtensionCodec=v.Encoder=v.DataViewIndexOutOfBoundsError=v.DecodeError=v.Decoder=v.decodeStream=v.decodeMultiStream=v.decodeArrayStream=v.decodeAsync=v.decodeMulti=v.decode=v.encode=void 0;var Ci=br();Object.defineProperty(v,"encode",{enumerable:!0,get:function(){return Ci.encode}});var Rr=kt();Object.defineProperty(v,"decode",{enumerable:!0,get:function(){return Rr.decode}});Object.defineProperty(v,"decodeMulti",{enumerable:!0,get:function(){return Rr.decodeMulti}});var st=Nr();Object.defineProperty(v,"decodeAsync",{enumerable:!0,get:function(){return st.decodeAsync}});Object.defineProperty(v,"decodeArrayStream",{enumerable:!0,get:function(){return st.decodeArrayStream}});Object.defineProperty(v,"decodeMultiStream",{enumerable:!0,get:function(){return st.decodeMultiStream}});Object.defineProperty(v,"decodeStream",{enumerable:!0,get:function(){return st.decodeStream}});var Fr=tt();Object.defineProperty(v,"Decoder",{enumerable:!0,get:function(){return Fr.Decoder}});Object.defineProperty(v,"DataViewIndexOutOfBoundsError",{enumerable:!0,get:function(){return Fr.DataViewIndexOutOfBoundsError}});var Ti=Ge();Object.defineProperty(v,"DecodeError",{enumerable:!0,get:function(){return Ti.DecodeError}});var bi=It();Object.defineProperty(v,"Encoder",{enumerable:!0,get:function(){return bi.Encoder}});var Oi=Je();Object.defineProperty(v,"ExtensionCodec",{enumerable:!0,get:function(){return Oi.ExtensionCodec}});var Ui=bt();Object.defineProperty(v,"ExtData",{enumerable:!0,get:function(){return Ui.ExtData}});var pe=Ot();Object.defineProperty(v,"EXT_TIMESTAMP",{enumerable:!0,get:function(){return pe.EXT_TIMESTAMP}});Object.defineProperty(v,"encodeDateToTimeSpec",{enumerable:!0,get:function(){return pe.encodeDateToTimeSpec}});Object.defineProperty(v,"encodeTimeSpecToTimestamp",{enumerable:!0,get:function(){return pe.encodeTimeSpecToTimestamp}});Object.defineProperty(v,"decodeTimestampToTimeSpec",{enumerable:!0,get:function(){return pe.decodeTimestampToTimeSpec}});Object.defineProperty(v,"encodeTimestampExtension",{enumerable:!0,get:function(){return pe.encodeTimestampExtension}});Object.defineProperty(v,"decodeTimestampExtension",{enumerable:!0,get:function(){return pe.decodeTimestampExtension}})});var Vr=x((Aa,$r)=>{var me=1e3,_e=me*60,ye=_e*60,fe=ye*24,Ii=fe*7,Ai=fe*365.25;$r.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return Li(r);if(t==="number"&&isFinite(r))return e.long?Di(r):Bi(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function Li(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),s=(e[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return t*Ai;case"weeks":case"week":case"w":return t*Ii;case"days":case"day":case"d":return t*fe;case"hours":case"hour":case"hrs":case"hr":case"h":return t*ye;case"minutes":case"minute":case"mins":case"min":case"m":return t*_e;case"seconds":case"second":case"secs":case"sec":case"s":return t*me;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Bi(r){var e=Math.abs(r);return e>=fe?Math.round(r/fe)+"d":e>=ye?Math.round(r/ye)+"h":e>=_e?Math.round(r/_e)+"m":e>=me?Math.round(r/me)+"s":r+"ms"}function Di(r){var e=Math.abs(r);return e>=fe?nt(r,e,fe,"day"):e>=ye?nt(r,e,ye,"hour"):e>=_e?nt(r,e,_e,"minute"):e>=me?nt(r,e,me,"second"):r+" ms"}function nt(r,e,t,s){var n=e>=t*1.5;return Math.round(r/t)+" "+s+(n?"s":"")}});var Nt=x((La,Wr)=>{function ki(r){t.debug=t,t.default=t,t.coerce=c,t.disable=i,t.enable=n,t.enabled=o,t.humanize=Vr(),t.destroy=l,Object.keys(r).forEach(h=>{t[h]=r[h]}),t.names=[],t.skips=[],t.formatters={};function e(h){let a=0;for(let d=0;d<h.length;d++)a=(a<<5)-a+h.charCodeAt(d),a|=0;return t.colors[Math.abs(a)%t.colors.length]}t.selectColor=e;function t(h){let a,d=null,m,y;function _(...E){if(!_.enabled)return;let u=_,p=Number(new Date),S=p-(a||p);u.diff=S,u.prev=a,u.curr=p,a=p,E[0]=t.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let g=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(C,P)=>{if(C==="%%")return"%";g++;let b=t.formatters[P];if(typeof b=="function"){let M=E[g];C=b.call(u,M),E.splice(g,1),g--}return C}),t.formatArgs.call(u,E),(u.log||t.log).apply(u,E)}return _.namespace=h,_.useColors=t.useColors(),_.color=t.selectColor(h),_.extend=s,_.destroy=t.destroy,Object.defineProperty(_,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(m!==t.namespaces&&(m=t.namespaces,y=t.enabled(h)),y),set:E=>{d=E}}),typeof t.init=="function"&&t.init(_),_}function s(h,a){let d=t(this.namespace+(typeof a>"u"?":":a)+h);return d.log=this.log,d}function n(h){t.save(h),t.namespaces=h,t.names=[],t.skips=[];let a,d=(typeof h=="string"?h:"").split(/[\s,]+/),m=d.length;for(a=0;a<m;a++)!d[a]||(h=d[a].replace(/\*/g,".*?"),h[0]==="-"?t.skips.push(new RegExp("^"+h.slice(1)+"$")):t.names.push(new RegExp("^"+h+"$")))}function i(){let h=[...t.names.map(f),...t.skips.map(f).map(a=>"-"+a)].join(",");return t.enable(""),h}function o(h){if(h[h.length-1]==="*")return!0;let a,d;for(a=0,d=t.skips.length;a<d;a++)if(t.skips[a].test(h))return!1;for(a=0,d=t.names.length;a<d;a++)if(t.names[a].test(h))return!0;return!1}function f(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}function c(h){return h instanceof Error?h.stack||h.message:h}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}Wr.exports=ki});var zr=x((R,it)=>{R.formatArgs=Mi;R.save=Ni;R.load=Ri;R.useColors=Pi;R.storage=Fi();R.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();R.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Pi(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Mi(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+it.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,s=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(s=t))}),r.splice(s,0,e)}R.log=console.debug||console.log||(()=>{});function Ni(r){try{r?R.storage.setItem("debug",r):R.storage.removeItem("debug")}catch{}}function Ri(){let r;try{r=R.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function Fi(){try{return localStorage}catch{}}it.exports=Nt()(R);var{formatters:qi}=it.exports;qi.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var jr=x((Ba,Hr)=>{"use strict";Hr.exports=(r,e=process.argv)=>{let t=r.startsWith("-")?"":r.length===1?"-":"--",s=e.indexOf(t+r),n=e.indexOf("--");return s!==-1&&(n===-1||s<n)}});var Kr=x((Da,Xr)=>{"use strict";var $i=require("os"),Gr=require("tty"),$=jr(),{env:U}=process,se;$("no-color")||$("no-colors")||$("color=false")||$("color=never")?se=0:($("color")||$("colors")||$("color=true")||$("color=always"))&&(se=1);"FORCE_COLOR"in U&&(U.FORCE_COLOR==="true"?se=1:U.FORCE_COLOR==="false"?se=0:se=U.FORCE_COLOR.length===0?1:Math.min(parseInt(U.FORCE_COLOR,10),3));function Rt(r){return r===0?!1:{level:r,hasBasic:!0,has256:r>=2,has16m:r>=3}}function Ft(r,e){if(se===0)return 0;if($("color=16m")||$("color=full")||$("color=truecolor"))return 3;if($("color=256"))return 2;if(r&&!e&&se===void 0)return 0;let t=se||0;if(U.TERM==="dumb")return t;if(process.platform==="win32"){let s=$i.release().split(".");return Number(s[0])>=10&&Number(s[2])>=10586?Number(s[2])>=14931?3:2:1}if("CI"in U)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(s=>s in U)||U.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in U)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(U.TEAMCITY_VERSION)?1:0;if(U.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in U){let s=parseInt((U.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(U.TERM_PROGRAM){case"iTerm.app":return s>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(U.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(U.TERM)||"COLORTERM"in U?1:t}function Vi(r){let e=Ft(r,r&&r.isTTY);return Rt(e)}Xr.exports={supportsColor:Vi,stdout:Rt(Ft(!0,Gr.isatty(1))),stderr:Rt(Ft(!0,Gr.isatty(2)))}});var Jr=x((A,at)=>{var Wi=require("tty"),ot=require("util");A.init=Yi;A.log=Gi;A.formatArgs=Hi;A.save=Xi;A.load=Ki;A.useColors=zi;A.destroy=ot.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");A.colors=[6,2,3,4,5,1];try{let r=Kr();r&&(r.stderr||r).level>=2&&(A.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}A.inspectOpts=Object.keys(process.env).filter(r=>/^debug_/i.test(r)).reduce((r,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(n,i)=>i.toUpperCase()),s=process.env[e];return/^(yes|on|true|enabled)$/i.test(s)?s=!0:/^(no|off|false|disabled)$/i.test(s)?s=!1:s==="null"?s=null:s=Number(s),r[t]=s,r},{});function zi(){return"colors"in A.inspectOpts?Boolean(A.inspectOpts.colors):Wi.isatty(process.stderr.fd)}function Hi(r){let{namespace:e,useColors:t}=this;if(t){let s=this.color,n="\x1B[3"+(s<8?s:"8;5;"+s),i=`  ${n};1m${e} \x1B[0m`;r[0]=i+r[0].split(`
`).join(`
`+i),r.push(n+"m+"+at.exports.humanize(this.diff)+"\x1B[0m")}else r[0]=ji()+e+" "+r[0]}function ji(){return A.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Gi(...r){return process.stderr.write(ot.format(...r)+`
`)}function Xi(r){r?process.env.DEBUG=r:delete process.env.DEBUG}function Ki(){return process.env.DEBUG}function Yi(r){r.inspectOpts={};let e=Object.keys(A.inspectOpts);for(let t=0;t<e.length;t++)r.inspectOpts[e[t]]=A.inspectOpts[e[t]]}at.exports=Nt()(A);var{formatters:Yr}=at.exports;Yr.o=function(r){return this.inspectOpts.colors=this.useColors,ot.inspect(r,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};Yr.O=function(r){return this.inspectOpts.colors=this.useColors,ot.inspect(r,this.inspectOpts)}});var Zr=x((ka,qt)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?qt.exports=zr():qt.exports=Jr()});var es=x((Pa,$t)=>{"use strict";var Ji=Object.prototype.hasOwnProperty,k="~";function Ae(){}Object.create&&(Ae.prototype=Object.create(null),new Ae().__proto__||(k=!1));function Zi(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function Qr(r,e,t,s,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var i=new Zi(t,s||r,n),o=k?k+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],i]:r._events[o].push(i):(r._events[o]=i,r._eventsCount++),r}function ct(r,e){--r._eventsCount===0?r._events=new Ae:delete r._events[e]}function B(){this._events=new Ae,this._eventsCount=0}B.prototype.eventNames=function(){var e=[],t,s;if(this._eventsCount===0)return e;for(s in t=this._events)Ji.call(t,s)&&e.push(k?s.slice(1):s);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};B.prototype.listeners=function(e){var t=k?k+e:e,s=this._events[t];if(!s)return[];if(s.fn)return[s.fn];for(var n=0,i=s.length,o=new Array(i);n<i;n++)o[n]=s[n].fn;return o};B.prototype.listenerCount=function(e){var t=k?k+e:e,s=this._events[t];return s?s.fn?1:s.length:0};B.prototype.emit=function(e,t,s,n,i,o){var f=k?k+e:e;if(!this._events[f])return!1;var c=this._events[f],l=arguments.length,h,a;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,s),!0;case 4:return c.fn.call(c.context,t,s,n),!0;case 5:return c.fn.call(c.context,t,s,n,i),!0;case 6:return c.fn.call(c.context,t,s,n,i,o),!0}for(a=1,h=new Array(l-1);a<l;a++)h[a-1]=arguments[a];c.fn.apply(c.context,h)}else{var d=c.length,m;for(a=0;a<d;a++)switch(c[a].once&&this.removeListener(e,c[a].fn,void 0,!0),l){case 1:c[a].fn.call(c[a].context);break;case 2:c[a].fn.call(c[a].context,t);break;case 3:c[a].fn.call(c[a].context,t,s);break;case 4:c[a].fn.call(c[a].context,t,s,n);break;default:if(!h)for(m=1,h=new Array(l-1);m<l;m++)h[m-1]=arguments[m];c[a].fn.apply(c[a].context,h)}}return!0};B.prototype.on=function(e,t,s){return Qr(this,e,t,s,!1)};B.prototype.once=function(e,t,s){return Qr(this,e,t,s,!0)};B.prototype.removeListener=function(e,t,s,n){var i=k?k+e:e;if(!this._events[i])return this;if(!t)return ct(this,i),this;var o=this._events[i];if(o.fn)o.fn===t&&(!n||o.once)&&(!s||o.context===s)&&ct(this,i);else{for(var f=0,c=[],l=o.length;f<l;f++)(o[f].fn!==t||n&&!o[f].once||s&&o[f].context!==s)&&c.push(o[f]);c.length?this._events[i]=c.length===1?c[0]:c:ct(this,i)}return this};B.prototype.removeAllListeners=function(e){var t;return e?(t=k?k+e:e,this._events[t]&&ct(this,t)):(this._events=new Ae,this._eventsCount=0),this};B.prototype.off=B.prototype.removeListener;B.prototype.addListener=B.prototype.on;B.prefixed=k;B.EventEmitter=B;typeof $t<"u"&&($t.exports=B)});var ne=x((Ma,ts)=>{"use strict";ts.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var Le=x((Na,ft)=>{"use strict";var{EMPTY_BUFFER:Qi}=ne();function eo(r,e){if(r.length===0)return Qi;if(r.length===1)return r[0];let t=Buffer.allocUnsafe(e),s=0;for(let n=0;n<r.length;n++){let i=r[n];t.set(i,s),s+=i.length}return s<e?t.slice(0,s):t}function rs(r,e,t,s,n){for(let i=0;i<n;i++)t[s+i]=r[i]^e[i&3]}function ss(r,e){for(let t=0;t<r.length;t++)r[t]^=e[t&3]}function to(r){return r.byteLength===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}function Vt(r){if(Vt.readOnly=!0,Buffer.isBuffer(r))return r;let e;return r instanceof ArrayBuffer?e=Buffer.from(r):ArrayBuffer.isView(r)?e=Buffer.from(r.buffer,r.byteOffset,r.byteLength):(e=Buffer.from(r),Vt.readOnly=!1),e}ft.exports={concat:eo,mask:rs,toArrayBuffer:to,toBuffer:Vt,unmask:ss};if(!process.env.WS_NO_BUFFER_UTIL)try{let r=require("bufferutil");ft.exports.mask=function(e,t,s,n,i){i<48?rs(e,t,s,n,i):r.mask(e,t,s,n,i)},ft.exports.unmask=function(e,t){e.length<32?ss(e,t):r.unmask(e,t)}}catch{}});var as=x((Ra,os)=>{"use strict";var ns=Symbol("kDone"),Wt=Symbol("kRun"),is=class{constructor(e){this[ns]=()=>{this.pending--,this[Wt]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[Wt]()}[Wt](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[ns])}}};os.exports=is});var ke=x((Fa,us)=>{"use strict";var Be=require("zlib"),cs=Le(),ro=as(),{kStatusCode:fs}=ne(),so=Buffer.from([0,0,255,255]),ut=Symbol("permessage-deflate"),J=Symbol("total-length"),De=Symbol("callback"),ie=Symbol("buffers"),ht=Symbol("error"),lt,ls=class{constructor(e,t,s){if(this._maxPayload=s|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!lt){let n=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;lt=new ro(n)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[De];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,s=e.find(n=>!(t.serverNoContextTakeover===!1&&n.server_no_context_takeover||n.server_max_window_bits&&(t.serverMaxWindowBits===!1||typeof t.serverMaxWindowBits=="number"&&t.serverMaxWindowBits>n.server_max_window_bits)||typeof t.clientMaxWindowBits=="number"&&!n.client_max_window_bits));if(!s)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(s.server_no_context_takeover=!0),t.clientNoContextTakeover&&(s.client_no_context_takeover=!0),typeof t.serverMaxWindowBits=="number"&&(s.server_max_window_bits=t.serverMaxWindowBits),typeof t.clientMaxWindowBits=="number"?s.client_max_window_bits=t.clientMaxWindowBits:(s.client_max_window_bits===!0||t.clientMaxWindowBits===!1)&&delete s.client_max_window_bits,s}acceptAsClient(e){let t=e[0];if(this._options.clientNoContextTakeover===!1&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!t.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(t.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return t}normalizeParams(e){return e.forEach(t=>{Object.keys(t).forEach(s=>{let n=t[s];if(n.length>1)throw new Error(`Parameter "${s}" must have only a single value`);if(n=n[0],s==="client_max_window_bits"){if(n!==!0){let i=+n;if(!Number.isInteger(i)||i<8||i>15)throw new TypeError(`Invalid value for parameter "${s}": ${n}`);n=i}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${s}": ${n}`)}else if(s==="server_max_window_bits"){let i=+n;if(!Number.isInteger(i)||i<8||i>15)throw new TypeError(`Invalid value for parameter "${s}": ${n}`);n=i}else if(s==="client_no_context_takeover"||s==="server_no_context_takeover"){if(n!==!0)throw new TypeError(`Invalid value for parameter "${s}": ${n}`)}else throw new Error(`Unknown parameter "${s}"`);t[s]=n})}),e}decompress(e,t,s){lt.add(n=>{this._decompress(e,t,(i,o)=>{n(),s(i,o)})})}compress(e,t,s){lt.add(n=>{this._compress(e,t,(i,o)=>{n(),s(i,o)})})}_decompress(e,t,s){let n=this._isServer?"client":"server";if(!this._inflate){let i=`${n}_max_window_bits`,o=typeof this.params[i]!="number"?Be.Z_DEFAULT_WINDOWBITS:this.params[i];this._inflate=Be.createInflateRaw(te(N({},this._options.zlibInflateOptions),{windowBits:o})),this._inflate[ut]=this,this._inflate[J]=0,this._inflate[ie]=[],this._inflate.on("error",io),this._inflate.on("data",hs)}this._inflate[De]=s,this._inflate.write(e),t&&this._inflate.write(so),this._inflate.flush(()=>{let i=this._inflate[ht];if(i){this._inflate.close(),this._inflate=null,s(i);return}let o=cs.concat(this._inflate[ie],this._inflate[J]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[J]=0,this._inflate[ie]=[],t&&this.params[`${n}_no_context_takeover`]&&this._inflate.reset()),s(null,o)})}_compress(e,t,s){let n=this._isServer?"server":"client";if(!this._deflate){let i=`${n}_max_window_bits`,o=typeof this.params[i]!="number"?Be.Z_DEFAULT_WINDOWBITS:this.params[i];this._deflate=Be.createDeflateRaw(te(N({},this._options.zlibDeflateOptions),{windowBits:o})),this._deflate[J]=0,this._deflate[ie]=[],this._deflate.on("data",no)}this._deflate[De]=s,this._deflate.write(e),this._deflate.flush(Be.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let i=cs.concat(this._deflate[ie],this._deflate[J]);t&&(i=i.slice(0,i.length-4)),this._deflate[De]=null,this._deflate[J]=0,this._deflate[ie]=[],t&&this.params[`${n}_no_context_takeover`]&&this._deflate.reset(),s(null,i)})}};us.exports=ls;function no(r){this[ie].push(r),this[J]+=r.length}function hs(r){if(this[J]+=r.length,this[ut]._maxPayload<1||this[J]<=this[ut]._maxPayload){this[ie].push(r);return}this[ht]=new RangeError("Max payload size exceeded"),this[ht].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[ht][fs]=1009,this.removeListener("data",hs),this.reset()}function io(r){this[ut]._inflate=null,r[fs]=1007,this[De](r)}});var Pe=x((qa,zt)=>{"use strict";var oo=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function ao(r){return r>=1e3&&r<=1014&&r!==1004&&r!==1005&&r!==1006||r>=3e3&&r<=4999}function ds(r){let e=r.length,t=0;for(;t<e;)if((r[t]&128)===0)t++;else if((r[t]&224)===192){if(t+1===e||(r[t+1]&192)!==128||(r[t]&254)===192)return!1;t+=2}else if((r[t]&240)===224){if(t+2>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||r[t]===224&&(r[t+1]&224)===128||r[t]===237&&(r[t+1]&224)===160)return!1;t+=3}else if((r[t]&248)===240){if(t+3>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||(r[t+3]&192)!==128||r[t]===240&&(r[t+1]&240)===128||r[t]===244&&r[t+1]>143||r[t]>244)return!1;t+=4}else return!1;return!0}zt.exports={isValidStatusCode:ao,isValidUTF8:ds,tokenChars:oo};if(!process.env.WS_NO_UTF_8_VALIDATE)try{let r=require("utf-8-validate");zt.exports.isValidUTF8=function(e){return e.length<150?ds(e):r(e)}}catch{}});var Gt=x(($a,vs)=>{"use strict";var{Writable:co}=require("stream"),ps=ke(),{BINARY_TYPES:fo,EMPTY_BUFFER:ms,kStatusCode:lo,kWebSocket:ho}=ne(),{concat:Ht,toArrayBuffer:uo,unmask:po}=Le(),{isValidStatusCode:mo,isValidUTF8:_s}=Pe(),Me=0,ys=1,gs=2,xs=3,jt=4,_o=5,ws=class extends co{constructor(e={}){super();this._binaryType=e.binaryType||fo[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[ho]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=Me,this._loop=!1}_write(e,t,s){if(this._opcode===8&&this._state==Me)return s();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(s)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let s=this._buffers[0];return this._buffers[0]=s.slice(e),s.slice(0,e)}let t=Buffer.allocUnsafe(e);do{let s=this._buffers[0],n=t.length-e;e>=s.length?t.set(this._buffers.shift(),n):(t.set(new Uint8Array(s.buffer,s.byteOffset,e),n),this._buffers[0]=s.slice(e)),e-=s.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do switch(this._state){case Me:t=this.getInfo();break;case ys:t=this.getPayloadLength16();break;case gs:t=this.getPayloadLength64();break;case xs:this.getMask();break;case jt:t=this.getData(e);break;default:this._loop=!1;return}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let e=this.consume(2);if((e[0]&48)!==0)return this._loop=!1,O(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let t=(e[0]&64)===64;if(t&&!this._extensions[ps.extensionName])return this._loop=!1,O(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(e[0]&128)===128,this._opcode=e[0]&15,this._payloadLength=e[1]&127,this._opcode===0){if(t)return this._loop=!1,O(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,O(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,O(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,O(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,O(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,O(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,O(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(e[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,O(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,O(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=ys;else if(this._payloadLength===127)this._state=gs;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,53-32)-1?(this._loop=!1,O(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,O(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=xs:this._state=jt}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=jt}getData(e){let t=ms;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&po(t,this._mask)}if(this._opcode>7)return this.controlMessage(t);if(this._compressed){this._state=_o,this.decompress(t,e);return}return t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage()}decompress(e,t){this._extensions[ps.extensionName].decompress(e,this._fin,(n,i)=>{if(n)return t(n);if(i.length){if(this._messageLength+=i.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(O(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(i)}let o=this.dataMessage();if(o)return t(o);this.startLoop(t)})}dataMessage(){if(this._fin){let e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let s;this._binaryType==="nodebuffer"?s=Ht(t,e):this._binaryType==="arraybuffer"?s=uo(Ht(t,e)):s=t,this.emit("message",s,!0)}else{let s=Ht(t,e);if(!this._skipUTF8Validation&&!_s(s))return this._loop=!1,O(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",s,!1)}}this._state=Me}controlMessage(e){if(this._opcode===8)if(this._loop=!1,e.length===0)this.emit("conclude",1005,ms),this.end();else{if(e.length===1)return O(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{let t=e.readUInt16BE(0);if(!mo(t))return O(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let s=e.slice(2);if(!this._skipUTF8Validation&&!_s(s))return O(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,s),this.end()}}else this._opcode===9?this.emit("ping",e):this.emit("pong",e);this._state=Me}};vs.exports=ws;function O(r,e,t,s,n){let i=new r(t?`Invalid WebSocket frame: ${e}`:e);return Error.captureStackTrace(i,O),i.code=n,i[lo]=s,i}});var Xt=x((za,Cs)=>{"use strict";var Va=require("net"),Wa=require("tls"),{randomFillSync:yo}=require("crypto"),Es=ke(),{EMPTY_BUFFER:go}=ne(),{isValidStatusCode:xo}=Pe(),{mask:Ss,toBuffer:ge}=Le(),V=Symbol("kByteLength"),wo=Buffer.alloc(4),Z=class{constructor(e,t,s){this._extensions=t||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let s,n=!1,i=2,o=!1;t.mask&&(s=t.maskBuffer||wo,t.generateMask?t.generateMask(s):yo(s,0,4),o=(s[0]|s[1]|s[2]|s[3])===0,i=6);let f;typeof e=="string"?(!t.mask||o)&&t[V]!==void 0?f=t[V]:(e=Buffer.from(e),f=e.length):(f=e.length,n=t.mask&&t.readOnly&&!o);let c=f;f>=65536?(i+=8,c=127):f>125&&(i+=2,c=126);let l=Buffer.allocUnsafe(n?f+i:i);return l[0]=t.fin?t.opcode|128:t.opcode,t.rsv1&&(l[0]|=64),l[1]=c,c===126?l.writeUInt16BE(f,2):c===127&&(l[2]=l[3]=0,l.writeUIntBE(f,4,6)),t.mask?(l[1]|=128,l[i-4]=s[0],l[i-3]=s[1],l[i-2]=s[2],l[i-1]=s[3],o?[l,e]:n?(Ss(e,s,l,i,f),[l]):(Ss(e,s,e,0,f),[l,e])):[l,e]}close(e,t,s,n){let i;if(e===void 0)i=go;else{if(typeof e!="number"||!xo(e))throw new TypeError("First argument must be a valid error code number");if(t===void 0||!t.length)i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0);else{let f=Buffer.byteLength(t);if(f>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+f),i.writeUInt16BE(e,0),typeof t=="string"?i.write(t,2):i.set(t,2)}}let o={[V]:i.length,fin:!0,generateMask:this._generateMask,mask:s,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,i,!1,o,n]):this.sendFrame(Z.frame(i,o),n)}ping(e,t,s){let n,i;if(typeof e=="string"?(n=Buffer.byteLength(e),i=!1):(e=ge(e),n=e.length,i=ge.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[V]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,s]):this.sendFrame(Z.frame(e,o),s)}pong(e,t,s){let n,i;if(typeof e=="string"?(n=Buffer.byteLength(e),i=!1):(e=ge(e),n=e.length,i=ge.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[V]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,s]):this.sendFrame(Z.frame(e,o),s)}send(e,t,s){let n=this._extensions[Es.extensionName],i=t.binary?2:1,o=t.compress,f,c;if(typeof e=="string"?(f=Buffer.byteLength(e),c=!1):(e=ge(e),f=e.length,c=ge.readOnly),this._firstFragment?(this._firstFragment=!1,o&&n&&n.params[n._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(o=f>=n._threshold),this._compress=o):(o=!1,i=0),t.fin&&(this._firstFragment=!0),n){let l={[V]:f,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:i,readOnly:c,rsv1:o};this._deflating?this.enqueue([this.dispatch,e,this._compress,l,s]):this.dispatch(e,this._compress,l,s)}else this.sendFrame(Z.frame(e,{[V]:f,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:i,readOnly:c,rsv1:!1}),s)}dispatch(e,t,s,n){if(!t){this.sendFrame(Z.frame(e,s),n);return}let i=this._extensions[Es.extensionName];this._bufferedBytes+=s[V],this._deflating=!0,i.compress(e,s.fin,(o,f)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");typeof n=="function"&&n(c);for(let l=0;l<this._queue.length;l++){let h=this._queue[l],a=h[h.length-1];typeof a=="function"&&a(c)}return}this._bufferedBytes-=s[V],this._deflating=!1,s.readOnly=!1,this.sendFrame(Z.frame(f,s),n),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][V],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][V],this._queue.push(e)}sendFrame(e,t){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};Cs.exports=Z});var ks=x((Ha,Ds)=>{"use strict";var{kForOnEventAttribute:Kt,kListener:Ts}=ne(),bs=Symbol("kCode"),Os=Symbol("kData"),Us=Symbol("kError"),Is=Symbol("kMessage"),As=Symbol("kReason"),xe=Symbol("kTarget"),Ls=Symbol("kType"),Bs=Symbol("kWasClean"),oe=class{constructor(e){this[xe]=null,this[Ls]=e}get target(){return this[xe]}get type(){return this[Ls]}};Object.defineProperty(oe.prototype,"target",{enumerable:!0});Object.defineProperty(oe.prototype,"type",{enumerable:!0});var we=class extends oe{constructor(e,t={}){super(e);this[bs]=t.code===void 0?0:t.code,this[As]=t.reason===void 0?"":t.reason,this[Bs]=t.wasClean===void 0?!1:t.wasClean}get code(){return this[bs]}get reason(){return this[As]}get wasClean(){return this[Bs]}};Object.defineProperty(we.prototype,"code",{enumerable:!0});Object.defineProperty(we.prototype,"reason",{enumerable:!0});Object.defineProperty(we.prototype,"wasClean",{enumerable:!0});var Ne=class extends oe{constructor(e,t={}){super(e);this[Us]=t.error===void 0?null:t.error,this[Is]=t.message===void 0?"":t.message}get error(){return this[Us]}get message(){return this[Is]}};Object.defineProperty(Ne.prototype,"error",{enumerable:!0});Object.defineProperty(Ne.prototype,"message",{enumerable:!0});var dt=class extends oe{constructor(e,t={}){super(e);this[Os]=t.data===void 0?null:t.data}get data(){return this[Os]}};Object.defineProperty(dt.prototype,"data",{enumerable:!0});var vo={addEventListener(r,e,t={}){let s;if(r==="message")s=function(i,o){let f=new dt("message",{data:o?i:i.toString()});f[xe]=this,e.call(this,f)};else if(r==="close")s=function(i,o){let f=new we("close",{code:i,reason:o.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});f[xe]=this,e.call(this,f)};else if(r==="error")s=function(i){let o=new Ne("error",{error:i,message:i.message});o[xe]=this,e.call(this,o)};else if(r==="open")s=function(){let i=new oe("open");i[xe]=this,e.call(this,i)};else return;s[Kt]=!!t[Kt],s[Ts]=e,t.once?this.once(r,s):this.on(r,s)},removeEventListener(r,e){for(let t of this.listeners(r))if(t[Ts]===e&&!t[Kt]){this.removeListener(r,t);break}}};Ds.exports={CloseEvent:we,ErrorEvent:Ne,Event:oe,EventTarget:vo,MessageEvent:dt}});var Yt=x((ja,Ps)=>{"use strict";var{tokenChars:Re}=Pe();function j(r,e,t){r[e]===void 0?r[e]=[t]:r[e].push(t)}function Eo(r){let e=Object.create(null),t=Object.create(null),s=!1,n=!1,i=!1,o,f,c=-1,l=-1,h=-1,a=0;for(;a<r.length;a++)if(l=r.charCodeAt(a),o===void 0)if(h===-1&&Re[l]===1)c===-1&&(c=a);else if(a!==0&&(l===32||l===9))h===-1&&c!==-1&&(h=a);else if(l===59||l===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${a}`);h===-1&&(h=a);let m=r.slice(c,h);l===44?(j(e,m,t),t=Object.create(null)):o=m,c=h=-1}else throw new SyntaxError(`Unexpected character at index ${a}`);else if(f===void 0)if(h===-1&&Re[l]===1)c===-1&&(c=a);else if(l===32||l===9)h===-1&&c!==-1&&(h=a);else if(l===59||l===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${a}`);h===-1&&(h=a),j(t,r.slice(c,h),!0),l===44&&(j(e,o,t),t=Object.create(null),o=void 0),c=h=-1}else if(l===61&&c!==-1&&h===-1)f=r.slice(c,a),c=h=-1;else throw new SyntaxError(`Unexpected character at index ${a}`);else if(n){if(Re[l]!==1)throw new SyntaxError(`Unexpected character at index ${a}`);c===-1?c=a:s||(s=!0),n=!1}else if(i)if(Re[l]===1)c===-1&&(c=a);else if(l===34&&c!==-1)i=!1,h=a;else if(l===92)n=!0;else throw new SyntaxError(`Unexpected character at index ${a}`);else if(l===34&&r.charCodeAt(a-1)===61)i=!0;else if(h===-1&&Re[l]===1)c===-1&&(c=a);else if(c!==-1&&(l===32||l===9))h===-1&&(h=a);else if(l===59||l===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${a}`);h===-1&&(h=a);let m=r.slice(c,h);s&&(m=m.replace(/\\/g,""),s=!1),j(t,f,m),l===44&&(j(e,o,t),t=Object.create(null),o=void 0),f=void 0,c=h=-1}else throw new SyntaxError(`Unexpected character at index ${a}`);if(c===-1||i||l===32||l===9)throw new SyntaxError("Unexpected end of input");h===-1&&(h=a);let d=r.slice(c,h);return o===void 0?j(e,d,t):(f===void 0?j(t,d,!0):s?j(t,f,d.replace(/\\/g,"")):j(t,f,d),j(e,o,t)),e}function So(r){return Object.keys(r).map(e=>{let t=r[e];return Array.isArray(t)||(t=[t]),t.map(s=>[e].concat(Object.keys(s).map(n=>{let i=s[n];return Array.isArray(i)||(i=[i]),i.map(o=>o===!0?n:`${n}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")}Ps.exports={format:So,parse:Eo}});var tr=x((Xa,js)=>{"use strict";var Co=require("events"),To=require("https"),bo=require("http"),Rs=require("net"),Oo=require("tls"),{randomBytes:Uo,createHash:Io}=require("crypto"),{Readable:Ga}=require("stream"),{URL:Jt}=require("url"),ae=ke(),Ao=Gt(),Lo=Xt(),{BINARY_TYPES:Ms,EMPTY_BUFFER:pt,GUID:Bo,kForOnEventAttribute:Zt,kListener:Do,kStatusCode:ko,kWebSocket:D,NOOP:Fs}=ne(),{EventTarget:{addEventListener:Po,removeEventListener:Mo}}=ks(),{format:No,parse:Ro}=Yt(),{toBuffer:Fo}=Le(),qo=30*1e3,qs=Symbol("kAborted"),Qt=[8,13],Q=["CONNECTING","OPEN","CLOSING","CLOSED"],$o=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,w=class extends Co{constructor(e,t,s){super();this._binaryType=Ms[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=pt,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=w.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,t===void 0?t=[]:Array.isArray(t)||(typeof t=="object"&&t!==null?(s=t,t=[]):t=[t]),$s(this,e,t,s)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){!Ms.includes(e)||(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,s){let n=new Ao({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation});this._sender=new Lo(e,this._extensions,s.generateMask),this._receiver=n,this._socket=e,n[D]=this,e[D]=this,n.on("conclude",zo),n.on("drain",Ho),n.on("error",jo),n.on("message",Go),n.on("ping",Xo),n.on("pong",Ko),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",Ws),e.on("data",_t),e.on("end",zs),e.on("error",Hs),this._readyState=w.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=w.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[ae.extensionName]&&this._extensions[ae.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=w.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==w.CLOSED){if(this.readyState===w.CONNECTING){let s="WebSocket was closed before the connection was established";return F(this,this._req,s)}if(this.readyState===w.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=w.CLOSING,this._sender.close(e,t,!this._isServer,s=>{s||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),qo)}}pause(){this.readyState===w.CONNECTING||this.readyState===w.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,t,s){if(this.readyState===w.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(s=e,e=t=void 0):typeof t=="function"&&(s=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==w.OPEN){er(this,e,s);return}t===void 0&&(t=!this._isServer),this._sender.ping(e||pt,t,s)}pong(e,t,s){if(this.readyState===w.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(s=e,e=t=void 0):typeof t=="function"&&(s=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==w.OPEN){er(this,e,s);return}t===void 0&&(t=!this._isServer),this._sender.pong(e||pt,t,s)}resume(){this.readyState===w.CONNECTING||this.readyState===w.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,s){if(this.readyState===w.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"&&(s=t,t={}),typeof e=="number"&&(e=e.toString()),this.readyState!==w.OPEN){er(this,e,s);return}let n=N({binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0},t);this._extensions[ae.extensionName]||(n.compress=!1),this._sender.send(e||pt,n,s)}terminate(){if(this.readyState!==w.CLOSED){if(this.readyState===w.CONNECTING){let e="WebSocket was closed before the connection was established";return F(this,this._req,e)}this._socket&&(this._readyState=w.CLOSING,this._socket.destroy())}}};Object.defineProperty(w,"CONNECTING",{enumerable:!0,value:Q.indexOf("CONNECTING")});Object.defineProperty(w.prototype,"CONNECTING",{enumerable:!0,value:Q.indexOf("CONNECTING")});Object.defineProperty(w,"OPEN",{enumerable:!0,value:Q.indexOf("OPEN")});Object.defineProperty(w.prototype,"OPEN",{enumerable:!0,value:Q.indexOf("OPEN")});Object.defineProperty(w,"CLOSING",{enumerable:!0,value:Q.indexOf("CLOSING")});Object.defineProperty(w.prototype,"CLOSING",{enumerable:!0,value:Q.indexOf("CLOSING")});Object.defineProperty(w,"CLOSED",{enumerable:!0,value:Q.indexOf("CLOSED")});Object.defineProperty(w.prototype,"CLOSED",{enumerable:!0,value:Q.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(r=>{Object.defineProperty(w.prototype,r,{enumerable:!0})});["open","error","close","message"].forEach(r=>{Object.defineProperty(w.prototype,`on${r}`,{enumerable:!0,get(){for(let e of this.listeners(r))if(e[Zt])return e[Do];return null},set(e){for(let t of this.listeners(r))if(t[Zt]){this.removeListener(r,t);break}typeof e=="function"&&this.addEventListener(r,e,{[Zt]:!0})}})});w.prototype.addEventListener=Po;w.prototype.removeEventListener=Mo;js.exports=w;function $s(r,e,t,s){let n=te(N({protocolVersion:Qt[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10},s),{createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0});if(!Qt.includes(n.protocolVersion))throw new RangeError(`Unsupported protocol version: ${n.protocolVersion} (supported versions: ${Qt.join(", ")})`);let i;if(e instanceof Jt)i=e,r._url=e.href;else{try{i=new Jt(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}r._url=e}let o=i.protocol==="wss:",f=i.protocol==="ws+unix:",c;if(i.protocol!=="ws:"&&!o&&!f?c=`The URL's protocol must be one of "ws:", "wss:", or "ws+unix:"`:f&&!i.pathname?c="The URL's pathname is empty":i.hash&&(c="The URL contains a fragment identifier"),c){let _=new SyntaxError(c);if(r._redirects===0)throw _;mt(r,_);return}let l=o?443:80,h=Uo(16).toString("base64"),a=o?To.request:bo.request,d=new Set,m;if(n.createConnection=o?Wo:Vo,n.defaultPort=n.defaultPort||l,n.port=i.port||l,n.host=i.hostname.startsWith("[")?i.hostname.slice(1,-1):i.hostname,n.headers=N({"Sec-WebSocket-Version":n.protocolVersion,"Sec-WebSocket-Key":h,Connection:"Upgrade",Upgrade:"websocket"},n.headers),n.path=i.pathname+i.search,n.timeout=n.handshakeTimeout,n.perMessageDeflate&&(m=new ae(n.perMessageDeflate!==!0?n.perMessageDeflate:{},!1,n.maxPayload),n.headers["Sec-WebSocket-Extensions"]=No({[ae.extensionName]:m.offer()})),t.length){for(let _ of t){if(typeof _!="string"||!$o.test(_)||d.has(_))throw new SyntaxError("An invalid or duplicated subprotocol was specified");d.add(_)}n.headers["Sec-WebSocket-Protocol"]=t.join(",")}if(n.origin&&(n.protocolVersion<13?n.headers["Sec-WebSocket-Origin"]=n.origin:n.headers.Origin=n.origin),(i.username||i.password)&&(n.auth=`${i.username}:${i.password}`),f){let _=n.path.split(":");n.socketPath=_[0],n.path=_[1]}let y;if(n.followRedirects){if(r._redirects===0){r._originalSecure=o,r._originalHost=i.host;let _=s&&s.headers;if(s=te(N({},s),{headers:{}}),_)for(let[E,u]of Object.entries(_))s.headers[E.toLowerCase()]=u}else if(r.listenerCount("redirect")===0){let _=i.host===r._originalHost;(!_||r._originalSecure&&!o)&&(delete n.headers.authorization,delete n.headers.cookie,_||delete n.headers.host,n.auth=void 0)}n.auth&&!s.headers.authorization&&(s.headers.authorization="Basic "+Buffer.from(n.auth).toString("base64")),y=r._req=a(n),r._redirects&&r.emit("redirect",r.url,y)}else y=r._req=a(n);n.timeout&&y.on("timeout",()=>{F(r,y,"Opening handshake has timed out")}),y.on("error",_=>{y===null||y[qs]||(y=r._req=null,mt(r,_))}),y.on("response",_=>{let E=_.headers.location,u=_.statusCode;if(E&&n.followRedirects&&u>=300&&u<400){if(++r._redirects>n.maxRedirects){F(r,y,"Maximum redirects exceeded");return}y.abort();let p;try{p=new Jt(E,e)}catch{let g=new SyntaxError(`Invalid URL: ${E}`);mt(r,g);return}$s(r,p,t,s)}else r.emit("unexpected-response",y,_)||F(r,y,`Unexpected server response: ${_.statusCode}`)}),y.on("upgrade",(_,E,u)=>{if(r.emit("upgrade",_),r.readyState!==w.CONNECTING)return;if(y=r._req=null,_.headers.upgrade.toLowerCase()!=="websocket"){F(r,E,"Invalid Upgrade header");return}let p=Io("sha1").update(h+Bo).digest("base64");if(_.headers["sec-websocket-accept"]!==p){F(r,E,"Invalid Sec-WebSocket-Accept header");return}let S=_.headers["sec-websocket-protocol"],g;if(S!==void 0?d.size?d.has(S)||(g="Server sent an invalid subprotocol"):g="Server sent a subprotocol but none was requested":d.size&&(g="Server sent no subprotocol"),g){F(r,E,g);return}S&&(r._protocol=S);let T=_.headers["sec-websocket-extensions"];if(T!==void 0){if(!m){F(r,E,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let C;try{C=Ro(T)}catch{F(r,E,"Invalid Sec-WebSocket-Extensions header");return}let P=Object.keys(C);if(P.length!==1||P[0]!==ae.extensionName){F(r,E,"Server indicated an extension that was not requested");return}try{m.accept(C[ae.extensionName])}catch{F(r,E,"Invalid Sec-WebSocket-Extensions header");return}r._extensions[ae.extensionName]=m}r.setSocket(E,u,{generateMask:n.generateMask,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation})}),y.end()}function mt(r,e){r._readyState=w.CLOSING,r.emit("error",e),r.emitClose()}function Vo(r){return r.path=r.socketPath,Rs.connect(r)}function Wo(r){return r.path=void 0,!r.servername&&r.servername!==""&&(r.servername=Rs.isIP(r.host)?"":r.host),Oo.connect(r)}function F(r,e,t){r._readyState=w.CLOSING;let s=new Error(t);Error.captureStackTrace(s,F),e.setHeader?(e[qs]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(mt,r,s)):(e.destroy(s),e.once("error",r.emit.bind(r,"error")),e.once("close",r.emitClose.bind(r)))}function er(r,e,t){if(e){let s=Fo(e).length;r._socket?r._sender._bufferedBytes+=s:r._bufferedAmount+=s}if(t){let s=new Error(`WebSocket is not open: readyState ${r.readyState} (${Q[r.readyState]})`);t(s)}}function zo(r,e){let t=this[D];t._closeFrameReceived=!0,t._closeMessage=e,t._closeCode=r,t._socket[D]!==void 0&&(t._socket.removeListener("data",_t),process.nextTick(Vs,t._socket),r===1005?t.close():t.close(r,e))}function Ho(){let r=this[D];r.isPaused||r._socket.resume()}function jo(r){let e=this[D];e._socket[D]!==void 0&&(e._socket.removeListener("data",_t),process.nextTick(Vs,e._socket),e.close(r[ko])),e.emit("error",r)}function Ns(){this[D].emitClose()}function Go(r,e){this[D].emit("message",r,e)}function Xo(r){let e=this[D];e.pong(r,!e._isServer,Fs),e.emit("ping",r)}function Ko(r){this[D].emit("pong",r)}function Vs(r){r.resume()}function Ws(){let r=this[D];this.removeListener("close",Ws),this.removeListener("data",_t),this.removeListener("end",zs),r._readyState=w.CLOSING;let e;!this._readableState.endEmitted&&!r._closeFrameReceived&&!r._receiver._writableState.errorEmitted&&(e=r._socket.read())!==null&&r._receiver.write(e),r._receiver.end(),this[D]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",Ns),r._receiver.on("finish",Ns))}function _t(r){this[D]._receiver.write(r)||this.pause()}function zs(){let r=this[D];r._readyState=w.CLOSING,r._receiver.end(),this.end()}function Hs(){let r=this[D];this.removeListener("error",Hs),this.on("error",Fs),r&&(r._readyState=w.CLOSING,this.destroy())}});var Ys=x((Ka,Ks)=>{"use strict";var{Duplex:Yo}=require("stream");function Gs(r){r.emit("close")}function Jo(){!this.destroyed&&this._writableState.finished&&this.destroy()}function Xs(r){this.removeListener("error",Xs),this.destroy(),this.listenerCount("error")===0&&this.emit("error",r)}function Zo(r,e){let t=!0,s=new Yo(te(N({},e),{autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1}));return r.on("message",function(i,o){let f=!o&&s._readableState.objectMode?i.toString():i;s.push(f)||r.pause()}),r.once("error",function(i){s.destroyed||(t=!1,s.destroy(i))}),r.once("close",function(){s.destroyed||s.push(null)}),s._destroy=function(n,i){if(r.readyState===r.CLOSED){i(n),process.nextTick(Gs,s);return}let o=!1;r.once("error",function(c){o=!0,i(c)}),r.once("close",function(){o||i(n),process.nextTick(Gs,s)}),t&&r.terminate()},s._final=function(n){if(r.readyState===r.CONNECTING){r.once("open",function(){s._final(n)});return}r._socket!==null&&(r._socket._writableState.finished?(n(),s._readableState.endEmitted&&s.destroy()):(r._socket.once("finish",function(){n()}),r.close()))},s._read=function(){r.isPaused&&r.resume()},s._write=function(n,i,o){if(r.readyState===r.CONNECTING){r.once("open",function(){s._write(n,i,o)});return}r.send(n,o)},s.on("end",Jo),s.on("error",Xs),s}Ks.exports=Zo});var Zs=x((Ya,Js)=>{"use strict";var{tokenChars:Qo}=Pe();function ea(r){let e=new Set,t=-1,s=-1,n=0;for(n;n<r.length;n++){let o=r.charCodeAt(n);if(s===-1&&Qo[o]===1)t===-1&&(t=n);else if(n!==0&&(o===32||o===9))s===-1&&t!==-1&&(s=n);else if(o===44){if(t===-1)throw new SyntaxError(`Unexpected character at index ${n}`);s===-1&&(s=n);let f=r.slice(t,s);if(e.has(f))throw new SyntaxError(`The "${f}" subprotocol is duplicated`);e.add(f),t=s=-1}else throw new SyntaxError(`Unexpected character at index ${n}`)}if(t===-1||s!==-1)throw new SyntaxError("Unexpected end of input");let i=r.slice(t,n);if(e.has(i))throw new SyntaxError(`The "${i}" subprotocol is duplicated`);return e.add(i),e}Js.exports={parse:ea}});var an=x((ec,on)=>{"use strict";var ta=require("events"),yt=require("http"),Ja=require("https"),Za=require("net"),Qa=require("tls"),{createHash:ra}=require("crypto"),Qs=Yt(),le=ke(),sa=Zs(),na=tr(),{GUID:ia,kWebSocket:oa}=ne(),aa=/^[+/0-9A-Za-z]{22}==$/,en=0,tn=1,sn=2,nn=class extends ta{constructor(e,t){super();if(e=N({maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:na},e),e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=yt.createServer((s,n)=>{let i=yt.STATUS_CODES[426];n.writeHead(426,{"Content-Length":i.length,"Content-Type":"text/plain"}),n.end(i)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let s=this.emit.bind(this,"connection");this._removeListeners=ca(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(n,i,o)=>{this.handleUpgrade(n,i,o,s)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=en}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===sn){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(Fe,this);return}if(e&&this.once("close",e),this._state!==tn)if(this._state=tn,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(Fe,this):process.nextTick(Fe,this);else{let t=this._server;this._removeListeners(),this._removeListeners=this._server=null,t.close(()=>{Fe(this)})}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((t!==-1?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,s,n){t.on("error",rn);let i=e.headers["sec-websocket-key"],o=+e.headers["sec-websocket-version"];if(e.method!=="GET"){he(this,e,t,405,"Invalid HTTP method");return}if(e.headers.upgrade.toLowerCase()!=="websocket"){he(this,e,t,400,"Invalid Upgrade header");return}if(!i||!aa.test(i)){he(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(o!==8&&o!==13){he(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){qe(t,400);return}let f=e.headers["sec-websocket-protocol"],c=new Set;if(f!==void 0)try{c=sa.parse(f)}catch{he(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let l=e.headers["sec-websocket-extensions"],h={};if(this.options.perMessageDeflate&&l!==void 0){let a=new le(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let d=Qs.parse(l);d[le.extensionName]&&(a.accept(d[le.extensionName]),h[le.extensionName]=a)}catch{he(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let a={origin:e.headers[`${o===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(a,(d,m,y,_)=>{if(!d)return qe(t,m||401,y,_);this.completeUpgrade(h,i,c,e,t,s,n)});return}if(!this.options.verifyClient(a))return qe(t,401)}this.completeUpgrade(h,i,c,e,t,s,n)}completeUpgrade(e,t,s,n,i,o,f){if(!i.readable||!i.writable)return i.destroy();if(i[oa])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>en)return qe(i,503);let c=ra("sha1").update(t+ia).digest("base64"),l=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${c}`],h=new this.options.WebSocket(null);if(s.size){let a=this.options.handleProtocols?this.options.handleProtocols(s,n):s.values().next().value;a&&(l.push(`Sec-WebSocket-Protocol: ${a}`),h._protocol=a)}if(e[le.extensionName]){let a=e[le.extensionName].params,d=Qs.format({[le.extensionName]:[a]});l.push(`Sec-WebSocket-Extensions: ${d}`),h._extensions=e}this.emit("headers",l,n),i.write(l.concat(`\r
`).join(`\r
`)),i.removeListener("error",rn),h.setSocket(i,o,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(h),h.on("close",()=>{this.clients.delete(h),this._shouldEmitClose&&!this.clients.size&&process.nextTick(Fe,this)})),f(h,n)}};on.exports=nn;function ca(r,e){for(let t of Object.keys(e))r.on(t,e[t]);return function(){for(let s of Object.keys(e))r.removeListener(s,e[s])}}function Fe(r){r._state=sn,r.emit("close")}function rn(){this.destroy()}function qe(r,e,t,s){t=t||yt.STATUS_CODES[e],s=N({Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(t)},s),r.once("finish",r.destroy),r.end(`HTTP/1.1 ${e} ${yt.STATUS_CODES[e]}\r
`+Object.keys(s).map(n=>`${n}: ${s[n]}`).join(`\r
`)+`\r
\r
`+t)}function he(r,e,t,s,n){if(r.listenerCount("wsClientError")){let i=new Error(n);Error.captureStackTrace(i,he),r.emit("wsClientError",i,t,e)}else qe(t,s,n)}});var fn=x((tc,cn)=>{"use strict";var ee=tr();ee.createWebSocketStream=Ys();ee.Server=an();ee.Receiver=Gt();ee.Sender=Xt();ee.WebSocket=ee;ee.WebSocketServer=ee.Server;cn.exports=ee});var hn=x((rc,ln)=>{"use strict";ln.exports=fn()});var rr=x((gt,un)=>{(function(r,e){typeof gt=="object"?un.exports=gt=e():typeof define=="function"&&define.amd?define([],e):r.CryptoJS=e()})(gt,function(){var r=r||function(e,t){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),typeof self<"u"&&self.crypto&&(s=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(s=globalThis.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof global<"u"&&global.crypto&&(s=global.crypto),!s&&typeof require=="function")try{s=require("crypto")}catch{}var n=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function u(){}return function(p){var S;return u.prototype=p,S=new u,u.prototype=null,S}}(),o={},f=o.lib={},c=f.Base=function(){return{extend:function(u){var p=i(this);return u&&p.mixIn(u),(!p.hasOwnProperty("init")||this.init===p.init)&&(p.init=function(){p.$super.init.apply(this,arguments)}),p.init.prototype=p,p.$super=this,p},create:function(){var u=this.extend();return u.init.apply(u,arguments),u},init:function(){},mixIn:function(u){for(var p in u)u.hasOwnProperty(p)&&(this[p]=u[p]);u.hasOwnProperty("toString")&&(this.toString=u.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=f.WordArray=c.extend({init:function(u,p){u=this.words=u||[],p!=t?this.sigBytes=p:this.sigBytes=u.length*4},toString:function(u){return(u||a).stringify(this)},concat:function(u){var p=this.words,S=u.words,g=this.sigBytes,T=u.sigBytes;if(this.clamp(),g%4)for(var C=0;C<T;C++){var P=S[C>>>2]>>>24-C%4*8&255;p[g+C>>>2]|=P<<24-(g+C)%4*8}else for(var b=0;b<T;b+=4)p[g+b>>>2]=S[b>>>2];return this.sigBytes+=T,this},clamp:function(){var u=this.words,p=this.sigBytes;u[p>>>2]&=4294967295<<32-p%4*8,u.length=e.ceil(p/4)},clone:function(){var u=c.clone.call(this);return u.words=this.words.slice(0),u},random:function(u){for(var p=[],S=0;S<u;S+=4)p.push(n());return new l.init(p,u)}}),h=o.enc={},a=h.Hex={stringify:function(u){for(var p=u.words,S=u.sigBytes,g=[],T=0;T<S;T++){var C=p[T>>>2]>>>24-T%4*8&255;g.push((C>>>4).toString(16)),g.push((C&15).toString(16))}return g.join("")},parse:function(u){for(var p=u.length,S=[],g=0;g<p;g+=2)S[g>>>3]|=parseInt(u.substr(g,2),16)<<24-g%8*4;return new l.init(S,p/2)}},d=h.Latin1={stringify:function(u){for(var p=u.words,S=u.sigBytes,g=[],T=0;T<S;T++){var C=p[T>>>2]>>>24-T%4*8&255;g.push(String.fromCharCode(C))}return g.join("")},parse:function(u){for(var p=u.length,S=[],g=0;g<p;g++)S[g>>>2]|=(u.charCodeAt(g)&255)<<24-g%4*8;return new l.init(S,p)}},m=h.Utf8={stringify:function(u){try{return decodeURIComponent(escape(d.stringify(u)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(u){return d.parse(unescape(encodeURIComponent(u)))}},y=f.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(u){typeof u=="string"&&(u=m.parse(u)),this._data.concat(u),this._nDataBytes+=u.sigBytes},_process:function(u){var p,S=this._data,g=S.words,T=S.sigBytes,C=this.blockSize,P=C*4,b=T/P;u?b=e.ceil(b):b=e.max((b|0)-this._minBufferSize,0);var M=b*C,Ve=e.min(M*4,T);if(M){for(var Se=0;Se<M;Se+=C)this._doProcessBlock(g,Se);p=g.splice(0,M),S.sigBytes-=Ve}return new l.init(p,Ve)},clone:function(){var u=c.clone.call(this);return u._data=this._data.clone(),u},_minBufferSize:0}),_=f.Hasher=y.extend({cfg:c.extend(),init:function(u){this.cfg=this.cfg.extend(u),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(u){return this._append(u),this._process(),this},finalize:function(u){u&&this._append(u);var p=this._doFinalize();return p},blockSize:512/32,_createHelper:function(u){return function(p,S){return new u.init(S).finalize(p)}},_createHmacHelper:function(u){return function(p,S){return new E.HMAC.init(u,S).finalize(p)}}}),E=o.algo={};return o}(Math);return r})});var pn=x((xt,dn)=>{(function(r,e){typeof xt=="object"?dn.exports=xt=e(rr()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(xt,function(r){return function(e){var t=r,s=t.lib,n=s.WordArray,i=s.Hasher,o=t.algo,f=[],c=[];(function(){function a(_){for(var E=e.sqrt(_),u=2;u<=E;u++)if(!(_%u))return!1;return!0}function d(_){return(_-(_|0))*4294967296|0}for(var m=2,y=0;y<64;)a(m)&&(y<8&&(f[y]=d(e.pow(m,1/2))),c[y]=d(e.pow(m,1/3)),y++),m++})();var l=[],h=o.SHA256=i.extend({_doReset:function(){this._hash=new n.init(f.slice(0))},_doProcessBlock:function(a,d){for(var m=this._hash.words,y=m[0],_=m[1],E=m[2],u=m[3],p=m[4],S=m[5],g=m[6],T=m[7],C=0;C<64;C++){if(C<16)l[C]=a[d+C]|0;else{var P=l[C-15],b=(P<<25|P>>>7)^(P<<14|P>>>18)^P>>>3,M=l[C-2],Ve=(M<<15|M>>>17)^(M<<13|M>>>19)^M>>>10;l[C]=b+l[C-7]+Ve+l[C-16]}var Se=p&S^~p&g,On=y&_^y&E^_&E,Un=(y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22),In=(p<<26|p>>>6)^(p<<21|p>>>11)^(p<<7|p>>>25),fr=T+In+Se+c[C]+l[C],An=Un+On;T=g,g=S,S=p,p=u+fr|0,u=E,E=_,_=y,y=fr+An|0}m[0]=m[0]+y|0,m[1]=m[1]+_|0,m[2]=m[2]+E|0,m[3]=m[3]+u|0,m[4]=m[4]+p|0,m[5]=m[5]+S|0,m[6]=m[6]+g|0,m[7]=m[7]+T|0},_doFinalize:function(){var a=this._data,d=a.words,m=this._nDataBytes*8,y=a.sigBytes*8;return d[y>>>5]|=128<<24-y%32,d[(y+64>>>9<<4)+14]=e.floor(m/4294967296),d[(y+64>>>9<<4)+15]=m,a.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var a=i.clone.call(this);return a._hash=this._hash.clone(),a}});t.SHA256=i._createHelper(h),t.HmacSHA256=i._createHmacHelper(h)}(Math),r.SHA256})});var _n=x((wt,mn)=>{(function(r,e){typeof wt=="object"?mn.exports=wt=e(rr()):typeof define=="function"&&define.amd?define(["./core"],e):e(r.CryptoJS)})(wt,function(r){return function(){var e=r,t=e.lib,s=t.WordArray,n=e.enc,i=n.Base64={stringify:function(f){var c=f.words,l=f.sigBytes,h=this._map;f.clamp();for(var a=[],d=0;d<l;d+=3)for(var m=c[d>>>2]>>>24-d%4*8&255,y=c[d+1>>>2]>>>24-(d+1)%4*8&255,_=c[d+2>>>2]>>>24-(d+2)%4*8&255,E=m<<16|y<<8|_,u=0;u<4&&d+u*.75<l;u++)a.push(h.charAt(E>>>6*(3-u)&63));var p=h.charAt(64);if(p)for(;a.length%4;)a.push(p);return a.join("")},parse:function(f){var c=f.length,l=this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var a=0;a<l.length;a++)h[l.charCodeAt(a)]=a}var d=l.charAt(64);if(d){var m=f.indexOf(d);m!==-1&&(c=m)}return o(f,c,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(f,c,l){for(var h=[],a=0,d=0;d<c;d++)if(d%4){var m=l[f.charCodeAt(d-1)]<<d%4*2,y=l[f.charCodeAt(d)]>>>6-d%4*2,_=m|y;h[a>>>2]|=_<<24-a%4*8,a++}return s.create(h,a)}}(),r.enc.Base64})});var ua={};Rn(ua,{default:()=>bn});var Et=ue(qr(),1),xn=ue(Zr(),1),sr=ue(es(),1),nr=ue(hn(),1),ir=ue(pn(),1),or=ue(_n(),1);function vt(){return vt=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},vt.apply(this,arguments)}function fa(r,e){if(r==null)return{};var t={},s=Object.keys(r),n,i;for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&(t[n]=r[n]);return t}var G;(function(r){r[r.Hello=0]="Hello",r[r.Identify=1]="Identify",r[r.Identified=2]="Identified",r[r.Reidentify=3]="Reidentify",r[r.Event=5]="Event",r[r.Request=6]="Request",r[r.RequestResponse=7]="RequestResponse",r[r.RequestBatch=8]="RequestBatch",r[r.RequestBatchResponse=9]="RequestBatchResponse"})(G||(G={}));var yn;(function(r){r[r.None=0]="None",r[r.General=1]="General",r[r.Config=2]="Config",r[r.Scenes=4]="Scenes",r[r.Inputs=8]="Inputs",r[r.Transitions=16]="Transitions",r[r.Filters=32]="Filters",r[r.Outputs=64]="Outputs",r[r.SceneItems=128]="SceneItems",r[r.MediaInputs=256]="MediaInputs",r[r.Vendors=512]="Vendors",r[r.Ui=1024]="Ui",r[r.All=1023]="All",r[r.InputVolumeMeters=65536]="InputVolumeMeters",r[r.InputActiveStateChanged=131072]="InputActiveStateChanged",r[r.InputShowStateChanged=262144]="InputShowStateChanged",r[r.SceneItemTransformChanged=524288]="SceneItemTransformChanged"})(yn||(yn={}));var gn;(function(r){r[r.None=-1]="None",r[r.SerialRealtime=0]="SerialRealtime",r[r.SerialFrame=1]="SerialFrame",r[r.Parallel=2]="Parallel"})(gn||(gn={}));function la(r,e,t){let s=or.default.stringify((0,ir.default)(t+r));return or.default.stringify((0,ir.default)(s+e))}var ha=["authentication","rpcVersion"],$e=(0,xn.default)("obs-websocket-js"),ve=class extends Error{constructor(e,t){super(t);this.code=void 0,this.code=e}},Ee=class extends sr.default{constructor(...e){super(...e);this._identified=!1,this.internalListeners=new sr.default,this.socket=void 0}static generateMessageId(){return String(Ee.requestCounter++)}get identified(){return this._identified}async connect(e="ws://127.0.0.1:4444",t,s={}){var n=this;this.socket&&await this.disconnect();try{let i=this.internalEventPromise("ConnectionClosed"),o=this.internalEventPromise("ConnectionError");return await Promise.race([async function(){let f=await n.createConnection(e);return n.emit("Hello",f),n.identify(f,t,s)}(),new Promise((f,c)=>{o.then(l=>{l.message&&c(l)}),i.then(l=>{c(l)})})])}catch(i){throw await this.disconnect(),i}}async disconnect(){if(!this.socket||this.socket.readyState===nr.default.CLOSED)return;let e=this.internalEventPromise("ConnectionClosed");this.socket.close(),await e}async reidentify(e){let t=this.internalEventPromise(`op:${G.Identified}`);return await this.message(G.Reidentify,e),t}async call(e,t){let s=Ee.generateMessageId(),n=this.internalEventPromise(`res:${s}`);await this.message(G.Request,{requestId:s,requestType:e,requestData:t});let{requestStatus:i,responseData:o}=await n;if(!i.result)throw new ve(i.code,i.comment);return o}cleanup(){!this.socket||(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket=void 0,this._identified=!1,this.internalListeners.removeAllListeners())}async createConnection(e){var t;let s=this.internalEventPromise("ConnectionOpened"),n=this.internalEventPromise(`op:${G.Hello}`);this.socket=new nr.default(e,this.protocol),this.socket.onopen=this.onOpen.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),await s;let i=(t=this.socket)==null?void 0:t.protocol;if(!i)throw new ve(-1,"Server sent no subprotocol");if(i!==this.protocol)throw new ve(-1,"Server sent an invalid subprotocol");return n}async identify(e,t,s={}){let{authentication:n,rpcVersion:i}=e,o=fa(e,ha),f=vt({rpcVersion:i},s);n&&t&&(f.authentication=la(n.salt,n.challenge,t));let c=this.internalEventPromise(`op:${G.Identified}`);await this.message(G.Identify,f);let l=await c;return this._identified=!0,this.emit("Identified",l),vt({rpcVersion:i},o,l)}async message(e,t){if(!this.socket)throw new Error("Not connected");if(!this.identified&&e!==1)throw new Error("Socket not identified");let s=await this.encodeMessage({op:e,d:t});this.socket.send(s)}async internalEventPromise(e){return new Promise(t=>{this.internalListeners.once(e,t)})}onOpen(e){$e("socket.open"),this.emit("ConnectionOpened"),this.internalListeners.emit("ConnectionOpened",e)}async onMessage(e){try{let{op:t,d:s}=await this.decodeMessage(e.data);if($e("socket.message: %d %j",t,s),t===void 0||s===void 0)return;switch(t){case G.Event:{let{eventType:n,eventData:i}=s;this.emit(n,i);return}case G.RequestResponse:{let{requestId:n}=s;this.internalListeners.emit(`res:${n}`,s);return}default:this.internalListeners.emit(`op:${t}`,s)}}catch(t){$e("error handling message: %o",t)}}onError(e){$e("socket.error: %o",e);let t=new ve(-1,e.message);this.emit("ConnectionError",t),this.internalListeners.emit("ConnectionError",t)}onClose(e){$e("socket.close: %s (%d)",e.reason,e.code);let t=new ve(e.code,e.reason);this.emit("ConnectionClosed",t),this.internalListeners.emit("ConnectionClosed",t),this.cleanup()}};Ee.requestCounter=1;typeof exports<"u"&&Object.defineProperty(exports,"__esModule",{value:!0});var ar=class extends Ee{constructor(...e){super(...e);this.protocol="obswebsocket.msgpack"}async encodeMessage(e){return(0,Et.encode)(e)}async decodeMessage(e){return typeof Blob<"u"&&e instanceof Blob&&(e=await e.arrayBuffer()),(0,Et.decode)(e)}};var vn=require("@raycast/api"),wn=(0,vn.getPreferenceValues)();async function En(){let r=new ar;return await r.connect(wn["obs-url"],wn["obs-password"]),r}var cr=require("@raycast/api");var X=require("@raycast/api"),Sn=async()=>{await(0,X.confirmAlert)({title:"OBS Studio is Not Installed",message:"OBS Studio not installed on your Mac. Please install and setup the websocket plugin to continue.",primaryAction:{title:"Get OBS Studio",onAction:()=>{(0,X.open)("https://obsproject.com/")}}})},Cn=async()=>(0,X.showToast)({title:"Websocket Connection Error",message:"Websocket connection error. Please check your connection and try again.",style:X.Toast.Style.Failure});async function Tn(){return!!(await(0,X.getApplications)()).find(e=>e.bundleId==="com.obsproject.obs-studio")}async function bn(){if(!await Tn())return Sn();let r;try{r=await En()}catch{return Cn()}let{outputActive:e}=await r.call("ToggleStream");e?(0,cr.showHUD)("Streaming"):(0,cr.showHUD)("Streaming stopped")}module.exports=Fn(ua);0&&(module.exports={});
